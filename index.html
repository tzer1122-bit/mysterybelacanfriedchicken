<script>
const restDays = ["Saturday"]; // 休息日
const openHour = 16, openMinute = 30;
const closeHour = 20, closeMinute = 30;

const qty = {
  popcorn_plain: 0, popcorn_salty: 0, popcorn_seaweed: 0, popcorn_spicy: 0, popcorn_cheese: 0,
  wing: 0, drumstick: 0, thigh: 0, fillet: 0, wedges: 0
};

const prices = {
  popcorn_plain: 7.5, popcorn_salty: 7.5, popcorn_seaweed: 7.5, popcorn_spicy: 7.5, popcorn_cheese: 7.5,
  wing: 3.5, drumstick: 5, thigh: 5, fillet: 7.5, wedges: 6.5
};

function changeQty(item, change) {
  qty[item] = Math.max(0, qty[item] + change);
  document.getElementById("qty-" + item).textContent = qty[item];
  updateTotal();
}

function updateTotal() {
  let total = 0;
  for (const key in qty) {
    total += qty[key] * prices[key];
  }
  document.getElementById("total").textContent = "🧾 总计：RM " + total.toFixed(2);
}

function checkBusinessHours() {
  const now = new Date();
  const dayName = now.toLocaleDateString('en-US', { weekday: 'long' });
  const hour = now.getHours(), minute = now.getMinutes();
  const closedDiv = document.getElementById("closed");
  const openNow = document.getElementById("openNow");
  const sendBtn = document.getElementById("sendOrder");

  const isRestDay = restDays.includes(dayName);
  let isOpen = false;

  if (!isRestDay) {
    const afterOpen = (hour > openHour) || (hour === openHour && minute >= openMinute);
    const beforeClose = (hour < closeHour) || (hour === closeHour && minute <= closeMinute);
    isOpen = afterOpen && beforeClose;
  }

  if (isRestDay || !isOpen) {
    // 未营业状态
    closedDiv.style.display = "block";
    openNow.style.display = "none";
    sendBtn.disabled = true;
    sendBtn.textContent = "🚫 未营业，无法发送";
    sendBtn.style.background = "#ccc";
    sendBtn.style.cursor = "not-allowed";
    sendBtn.style.boxShadow = "none";
  } else {
    // 营业中状态
    closedDiv.style.display = "none";
    openNow.style.display = "block";
    openNow.textContent = "✅ 正在营业中！欢迎下单～";
    sendBtn.disabled = false;
    sendBtn.textContent = "📩 发送 WhatsApp 下单";
    sendBtn.style.background = "#25D366";
    sendBtn.style.cursor = "pointer";
    sendBtn.style.boxShadow = "0 4px 10px rgba(37,211,102,0.4)";
  }
}

document.getElementById("sendOrder").addEventListener("click", function() {
  if (this.disabled) return; // 若未营业则不动作

  const phone = "60103715668";
  const now = new Date();
  const dateTime = now.toLocaleString("zh-CN", { hour12: false });
  let msg = "🍗 Mystery Belacan Fried Chicken 下单通知\n\n";
  msg += "🕒 下单时间：" + dateTime + "\n\n";

  const nameMap = {
    popcorn_plain: "Chicken Popcorn (原味)",
    popcorn_salty: "Chicken Popcorn (盐酥)",
    popcorn_seaweed: "Chicken Popcorn (海苔)",
    popcorn_spicy: "Chicken Popcorn (麻辣)",
    popcorn_cheese: "Chicken Popcorn (起司)",
    wing: "Chicken Wing",
    drumstick: "Chicken Drumstick",
    thigh: "Chicken Thigh",
    fillet: "Chicken Breast Fillet",
    wedges: "Cheesy Wedges"
  };

  let total = 0;
  for (const key in qty) {
    if (qty[key] > 0) {
      msg += `- ${nameMap[key]} × ${qty[key]}\n`;
      total += qty[key] * prices[key];
    }
  }

  msg += `\n🧾 总计：RM ${total.toFixed(2)}\n\n请附上付款截图，谢谢！😊`;
  window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, "_blank");
});

checkBusinessHours();
</script>
</body>
</html>

